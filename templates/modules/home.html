{% extends 'base.html' %}

{% block title %}Home - Module Manager{% endblock %}

{% block main_class %}{% endblock %}

{% block content %}
{% if user.is_authenticated %}
<!-- Dashboard for logged-in users -->
<div class="hero-section py-5">
	<div class="container">
		<div class="row align-items-center">
			<div class="col-lg-8">
				<h1 class="display-4 fw-bold mb-3">Welcome back, {{
					user.first_name|default:user.username }}!</h1>
				<p class="lead mb-4">Manage your university modules efficiently and professionally.</p>
				<a href="{% url 'module_create' %}"
					class="btn btn-light btn-lg btn-gradient text-white">
					<i class="bi bi-plus-circle me-2"></i>Create New Module
				</a>
			</div>
			<div class="col-lg-4 text-center">
				<i class="bi bi-mortarboard display-1"></i>
			</div>
		</div>
	</div>
</div>

<div class="container py-5">
	<div class="row">
		<!-- Stats Cards -->
		<div class="col-md-4 mb-4">
			<div class="card stats-card h-100">
				<div class="card-body">
					<div class="d-flex justify-content-between align-items-center">
						<div>
							<h5 class="card-title text-muted">Total Modules</h5>
							<h2 class="text-primary">{{ modules.count }}</h2>
						</div>
						<i class="bi bi-collection text-primary" style="font-size: 2rem;"></i>
					</div>
				</div>
			</div>
		</div>

		<div class="col-md-4 mb-4">
			<div class="card stats-card h-100">
				<div class="card-body">
					<div class="d-flex justify-content-between align-items-center">
						<div>
							<h5 class="card-title text-muted">Total Credits</h5>
							<h2 class="text-success">
								{% if modules %}
								{% for module in modules %}
								{{ module.credits }}{% if not forloop.last %} + {% endif %}
								{% endfor %}
								{% else %}
								0
								{% endif %}
							</h2>
						</div>
						<i class="bi bi-trophy text-success" style="font-size: 2rem;"></i>
					</div>
				</div>
			</div>
		</div>

		<div class="col-md-4 mb-4">
			<div class="card stats-card h-100">
				<div class="card-body">
					<div class="d-flex justify-content-between align-items-center">
						<div>
							<h5 class="card-title text-muted">Recent Activity</h5>
							<h2 class="text-info">
								{% if modules %}{{ modules.first.updated_at|timesince }}
								ago{% else %}None{% endif %}
							</h2>
						</div>
						<i class="bi bi-clock-history text-info" style="font-size: 2rem;"></i>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Recent Modules -->
	{% if modules %}
	<div class="row">
		<div class="col-12">
			<h3 class="mb-4">Recent Modules</h3>
			<div class="row">
				{% for module in modules|slice:":3" %}
				<div class="col-lg-4 mb-4">
					<div class="card card-hover h-100">
						<div class="card-body">
							<h5 class="card-title">{{ module.name }}</h5>
							<p class="card-text text-muted">{{ module.code }} â€¢ {{
								module.credits }} credits</p>
							<p class="card-text">{{ module.department }}</p>
							<div class="d-flex justify-content-between align-items-center">
								<small class="text-muted">Updated {{
									module.updated_at|timesince }} ago</small>
								<a href="{% url 'module_detail' module.pk %}"
									class="btn btn-outline-primary">
									View <i class="bi bi-arrow-right"></i>
								</a>
							</div>
						</div>
					</div>
				</div>
				{% endfor %}
			</div>

			{% if modules.count > 3 %}
			<div class="text-center mt-4">
				<a href="{% url 'module_list' %}" class="btn btn-primary">
					View All Modules <i class="bi bi-arrow-right"></i>
				</a>
			</div>
			{% endif %}
		</div>
	</div>
	{% else %}
	<div class="text-center py-5">
		<i class="bi bi-inbox display-1 text-muted"></i>
		<h3 class="mt-3 text-muted">No modules yet</h3>
		<p class="text-muted">Create your first module to get started!</p>
		<a href="{% url 'module_create' %}" class="btn btn-primary btn-lg">
			<i class="bi bi-plus-circle me-2"></i>Create First Module
		</a>
	</div>
	{% endif %}
</div>

{% else %}
<!-- Landing page for non-authenticated users -->
<div class="hero-section py-5">
	<div class="container">
		<div class="row align-items-center min-vh-75">
			<div class="col-lg-6">
				<h1 class="display-3 fw-bold mb-4">Module Manager</h1>
				<p class="lead mb-4">Organize and manage your university course modules with ease.
					Create professional module descriptions, track competencies, and generate PDF
					documents.</p>
				<div class="d-flex gap-3">
					<a href="{% url 'register' %}" class="btn btn-light btn-lg">
						<i class="bi bi-person-plus me-2"></i>Get Started
					</a>
					<a href="{% url 'login' %}" class="btn btn-outline-light btn-lg">
						<i class="bi bi-box-arrow-in-right me-2"></i>Login
					</a>
				</div>
			</div>
			<div class="col-lg-6 text-center">
				<i class="bi bi-journal-text display-1"></i>
			</div>
		</div>
	</div>
</div>

<div class="container py-5">
	<div class="row">
		<div class="col-lg-4 text-center mb-4">
			<i class="bi bi-file-earmark-text text-primary display-4 mb-3"></i>
			<h4>Create Modules</h4>
			<p class="text-muted">Design comprehensive module descriptions with all necessary academic
				details.</p>
		</div>
		<div class="col-lg-4 text-center mb-4">
			<i class="bi bi-shield-check text-success display-4 mb-3"></i>
			<h4>Secure & Private</h4>
			<p class="text-muted">Your modules are private and only accessible to you.</p>
		</div>
		<div class="col-lg-4 text-center mb-4">
			<i class="bi bi-file-pdf text-danger display-4 mb-3"></i>
			<h4>Export to PDF</h4>
			<p class="text-muted">Generate professional PDF documents for official use.</p>
		</div>
	</div>
</div>
{% endif %}
{% endblock %}
